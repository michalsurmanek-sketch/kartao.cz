<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Oce≈àov√°n√≠ - Kartao.cz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              fuchsia: tailwind.colors.fuchsia,
              amber: tailwind.colors.amber,
              neutral: tailwind.colors.neutral,
              emerald: tailwind.colors.emerald,
              sky: tailwind.colors.sky,
              rose: tailwind.colors.rose,
            }
          }
        }
      }
    </script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="firebase-init.js"></script>
  <script src="auth.js"></script>
  <script src="auth-header.js"></script>
  <script src="credits-system.js"></script>
  <script src="credits-header.js"></script>
    <script src="ai-pricing-system.js"></script>
</head>
<body class="bg-gradient-to-b from-neutral-950 via-neutral-950 to-black text-white">
    <div class="min-h-screen p-4 md:p-8">
        <!-- Header (Kartao styl) -->
<header class="sticky top-0 z-50 backdrop-blur supports-[backdrop-filter]:bg-neutral-950/80 bg-neutral-950/60 border-b border-white/10">
  <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
    <a href="index.html" class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-2xl bg-gradient-to-tr from-fuchsia-500 to-amber-400 grid place-items-center shadow">
        <i data-lucide="crown" class="w-5 h-5 text-neutral-900"></i>
      </div>
      <span class="font-semibold text-white text-lg">Kartao.cz</span>
    </a>
    <nav class="hidden md:flex items-center gap-6 text-white/80">
      <a href="kartao-marketplace.html" class="hover:text-white transition">Marketplace</a>
      <a href="kartao-zalozit-kartu.html" class="hover:text-white transition">Zalo≈æit kartu</a>
      <a href="kartao-zadat-kampan.html" class="hover:text-white transition">Zadat kampa≈à</a>
    </nav>
  </div>
</header>

<!-- Main Content -->
        <div class="max-w-7xl mx-auto">
            <!-- Quick Pricing Calculator -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8 mb-8">
                <div class="lg:col-span-2 bg-neutral-950/80 border border-white/10 rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.6)] p-6 md:p-8">
                    <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                        <span class="inline-flex h-9 w-9 rounded-2xl bg-gradient-to-tr from-fuchsia-500 to-amber-400 items-center justify-center mr-1">
                            <i data-lucide="calculator" class="w-5 h-5 text-neutral-950"></i>
                        </span>
                        <span>Kalkulaƒçka cen</span>
                    </h2>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Creator Selection -->
                        <div>
                            <label class="block text-xs font-semibold tracking-wide text-white/60 mb-2 uppercase">Vyberte tv≈Ørce</label>
                            <select id="creatorSelect" class="w-full px-3 py-2.5 rounded-xl bg-neutral-900 border border-white/10 text-sm text-white/90 focus:outline-none focus:ring-2 focus:ring-amber-400/60 focus:border-amber-300">
                                <option value="" class="bg-neutral-900">Naƒç√≠t√°n√≠ tv≈Ørc≈Ø...</option>
                            </select>
                        </div>

                        <!-- Content Type Selection -->
                        <div>
                            <label class="block text-xs font-semibold tracking-wide text-white/60 mb-2 uppercase">Typ obsahu</label>
                            <select id="contentTypeSelect" class="w-full px-3 py-2.5 rounded-xl bg-neutral-900 border border-white/10 text-sm text-white/90 focus:outline-none focus:ring-2 focus:ring-amber-400/60 focus:border-amber-300">
                                <option value="instagram_post">Instagram Post</option>
                                <option value="instagram_story">Instagram Story</option>
                                <option value="instagram_reel">Instagram Reel</option>
                                <option value="tiktok_video">TikTok Video</option>
                                <option value="youtube_video">YouTube Video</option>
                                <option value="youtube_short">YouTube Short</option>
                                <option value="sponsored_post">Sponzorovan√Ω post</option>
                                <option value="brand_collaboration">Brand spolupr√°ce</option>
                                <option value="event_appearance">√öƒçast na ud√°losti</option>
                            </select>
                        </div>
                    </div>

                    <button id="calculatePriceBtn" class="mt-6 w-full bg-gradient-to-r from-fuchsia-500 via-amber-400 to-emerald-400 text-neutral-950 py-3 px-6 rounded-full font-semibold hover:shadow-[0_0_35px_rgba(250,204,21,0.4)] transition duration-300 flex items-center justify-center gap-2">
                        <i data-lucide="zap" class="w-5 h-5"></i>
                        <span>Vypoƒç√≠tat doporuƒçenou cenu</span>
                    </button>
                </div>

                <!-- Quick Stats -->
                <div class="bg-neutral-950/80 border border-white/10 rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.6)] p-6 md:p-6">
                    <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                        <i data-lucide="activity" class="w-5 h-5 text-emerald-400"></i>
                        <span>Rychl√© statistiky Kartao</span>
                    </h3>
                    <div class="space-y-4">
                        <div class="p-4 rounded-xl bg-gradient-to-r from-fuchsia-500/10 via-amber-400/5 to-transparent border border-fuchsia-500/30">
                            <div class="flex items-center justify-between">
                                <span class="text-xs font-medium text-white/60 uppercase">Pr≈Ømƒõrn√° cena (Instagram Post)</span>
                                <span class="text-xl font-bold text-amber-300" id="avgInstagramPrice">2,500 Kƒç</span>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl bg-gradient-to-r from-emerald-500/10 via-emerald-400/5 to-transparent border border-emerald-500/30">
                            <div class="flex items-center justify-between">
                                <span class="text-xs font-medium text-white/60 uppercase">Aktivn√≠ch tv≈Ørc≈Ø</span>
                                <span class="text-xl font-bold text-emerald-300" id="activeCreatorsCount">0</span>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl bg-gradient-to-r from-sky-500/10 via-sky-400/5 to-transparent border border-sky-500/30">
                            <div class="flex items-center justify-between">
                                <span class="text-xs font-medium text-white/60 uppercase">Ocenƒõn√Ωch profil≈Ø</span>
                                <span class="text-xl font-bold text-sky-300" id="pricedProfilesCount">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pricing Results -->
            <div id="pricingResults" class="hidden mb-8">
                <div class="bg-neutral-950/80 border border-white/10 rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.6)] p-6 md:p-8">
                    <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
                        <i data-lucide="target" class="w-5 h-5 text-emerald-400"></i>
                        <span>V√Ωsledky oce≈àov√°n√≠</span>
                    </h3>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- Price Recommendation -->
                        <div>
                            <div class="bg-gradient-to-br from-fuchsia-500/10 via-amber-400/10 to-emerald-400/10 border border-white/10 rounded-2xl p-6 mb-6">
                                <h4 class="text-lg font-bold text-white mb-4">üéØ Doporuƒçen√° cena</h4>
                                <div class="text-center">
                                    <div class="text-3xl md:text-4xl font-extrabold text-amber-300 mb-2" id="recommendedPrice">0 Kƒç</div>
                                    <div class="text-xs md:text-sm text-white/60 mb-4">
                                        Rozmez√≠: <span id="priceRange">0 - 0 Kƒç</span>
                                    </div>
                                    <div class="flex flex-col items-center gap-2">
                                        <span class="text-xs font-medium text-white/60 uppercase tracking-wide">Spolehlivost odhadu</span>
                                        <div class="flex items-center gap-3">
                                            <div class="w-24 h-2 bg-white/10 rounded-full overflow-hidden">
                                                <div id="confidenceBar" class="h-2 bg-gradient-to-r from-emerald-400 via-amber-300 to-fuchsia-400 rounded-full transition-all duration-500" style="width: 0%"></div>
                                            </div>
                                            <span id="confidenceText" class="text-sm font-semibold text-white">0%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Factors Breakdown -->
                            <div id="factorsBreakdown" class="space-y-3">
                                <!-- Dynamically populated -->
                            </div>
                        </div>

                        <!-- Creator Analysis -->
                        <div>
                            <div class="bg-neutral-900/80 border border-white/10 rounded-2xl p-6">
                                <h4 class="text-lg font-bold text-white mb-4">üìä Anal√Ωza profilu tv≈Ørce</h4>
                                
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-white/5">
                                        <span class="text-sm font-medium text-white/60">Celkem follower≈Ø</span>
                                        <span class="font-semibold text-white" id="totalFollowers">0</span>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-white/5">
                                        <span class="text-sm font-medium text-white/60">Pr≈Ømƒõrn√Ω engagement</span>
                                        <span class="font-semibold text-emerald-300" id="avgEngagement">0%</span>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-white/5">
                                        <span class="text-sm font-medium text-white/60">Tier follower≈Ø</span>
                                        <span class="font-semibold text-white" id="followerTier">-</span>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-white/5">
                                        <span class="text-sm font-medium text-white/60">Kvalita engagementu</span>
                                        <span class="font-semibold text-white" id="engagementQuality">-</span>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-white/5">
                                        <span class="text-sm font-medium text-white/60">Reputace</span>
                                        <span class="font-semibold text-white" id="reputationQuality">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Market Comparison -->
                    <div id="marketComparison" class="mt-8 p-6 bg-gradient-to-r from-emerald-500/10 via-sky-500/10 to-fuchsia-500/10 border border-white/10 rounded-2xl">
                        <!-- Dynamically populated -->
                    </div>
                </div>
            </div>

            <!-- Category Trends & AI Insights -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 md:gap-8 mb-8">
                <div class="bg-neutral-950/80 border border-white/10 rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.6)] p-6 md:p-6">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                        <i data-lucide="trending-up" class="w-5 h-5 text-emerald-400"></i>
                        <span>Trendy podle kategori√≠</span>
                    </h3>

                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-fuchsia-500/30">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-fuchsia-400 rounded-full mr-3"></div>
                                <span class="font-medium text-white">Beauty & Fashion</span>
                            </div>
                            <span class="text-emerald-300 font-semibold">+12%</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-sky-500/30">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-sky-400 rounded-full mr-3"></div>
                                <span class="font-medium text-white">Tech & Gaming</span>
                            </div>
                            <span class="text-rose-300 font-semibold">-5%</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-emerald-500/30">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-emerald-400 rounded-full mr-3"></div>
                                <span class="font-medium text-white">Fitness & Health</span>
                            </div>
                            <span class="text-emerald-300 font-semibold">+8%</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-amber-500/30">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-amber-300 rounded-full mr-3"></div>
                                <span class="font-medium text-white">Food & Travel</span>
                            </div>
                            <span class="text-amber-200 font-semibold">0%</span>
                        </div>
                    </div>

                    <button id="analyzeTrendsBtn" class="mt-4 w-full bg-gradient-to-r from-emerald-400 via-sky-400 to-fuchsia-400 text-neutral-950 py-2.5 px-4 rounded-full text-sm font-semibold hover:shadow-[0_0_30px_rgba(52,211,153,0.4)] transition duration-300">
                        Podrobn√° anal√Ωza trend≈Ø (brzy)
                    </button>
                </div>

                <!-- AI Insights -->
                <div class="bg-neutral-950/80 border border-white/10 rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.6)] p-6 md:p-6">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                        <i data-lucide="brain" class="w-5 h-5 text-fuchsia-400"></i>
                        <span>AI doporuƒçen√≠</span>
                    </h3>

                    <div id="aiInsights" class="space-y-3">
                        <div class="p-4 bg-fuchsia-500/10 border-l-4 border-fuchsia-400 rounded-xl">
                            <p class="text-sm text-fuchsia-100 font-medium">üí° Tip: Influence≈ôi s engagementem nad 3 % dosahuj√≠ v pr≈Ømƒõru o ~40 % vy≈°≈°√≠ch cen za spolupr√°ci.</p>
                        </div>
                        <div class="p-4 bg-emerald-500/10 border-l-4 border-emerald-400 rounded-xl">
                            <p class="text-sm text-emerald-100 font-medium">üìà Trend: Beauty & Fashion kategorie m√° moment√°lnƒõ nejvƒõt≈°√≠ tlak na r≈Øst cen kampan√≠.</p>
                        </div>
                        <div class="p-4 bg-sky-500/10 border-l-4 border-sky-400 rounded-xl">
                            <p class="text-sm text-sky-100 font-medium">üéØ Bonus: Tv≈Ørci s ovƒõ≈ôen√Ωmi √∫ƒçty a kompletn√≠ kartou na Kartao.cz dosahuj√≠ v pr≈Ømƒõru o 15 % vy≈°≈°√≠ch cen.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Batch Operations -->
            <div class="bg-neutral-950/80 border border-white/10 rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.6)] p-6 md:p-8">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i data-lucide="settings" class="w-5 h-5 text-white/70"></i>
                    <span>Hromadn√© operace</span>
                </h3>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button id="updateAllPricesBtn" class="bg-gradient-to-r from-fuchsia-500 via-amber-400 to-emerald-400 text-neutral-950 py-3 px-6 rounded-xl font-semibold text-sm hover:shadow-[0_0_30px_rgba(251,191,36,0.5)] transition duration-300 flex items-center justify-center gap-2">
                        <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                        <span>Aktualizovat v≈°echny ceny</span>
                    </button>
                    
                    <button id="exportDataBtn" class="bg-gradient-to-r from-emerald-500 to-sky-400 text-neutral-950 py-3 px-6 rounded-xl font-semibold text-sm hover:shadow-[0_0_30px_rgba(52,211,153,0.5)] transition duration-300 flex items-center justify-center gap-2">
                        <i data-lucide="download" class="w-5 h-5"></i>
                        <span>Exportovat data</span>
                    </button>
                    
                    <button id="generateReportBtn" class="bg-gradient-to-r from-amber-400 to-rose-400 text-neutral-950 py-3 px-6 rounded-xl font-semibold text-sm hover:shadow-[0_0_30px_rgba(251,113,133,0.5)] transition duration-300 flex items-center justify-center gap-2">
                        <i data-lucide="file-text" class="w-5 h-5"></i>
                        <span>Vygenerovat report</span>
                    </button>
                </div>

                <!-- Batch Progress -->
                <div id="batchProgress" class="hidden mt-6">
                    <div class="bg-white/10 rounded-full h-3 overflow-hidden">
                        <div id="batchProgressBar" class="bg-gradient-to-r from-fuchsia-500 via-amber-400 to-emerald-400 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                    <p id="batchProgressText" class="text-xs md:text-sm text-white/60 mt-2">Zpracov√°v√°no...</p>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
            <div class="bg-neutral-950 border border-white/10 rounded-2xl p-8 max-w-sm w-full mx-4 text-center shadow-[0_0_40px_rgba(0,0,0,0.7)]">
                <div class="mx-auto mb-4 h-16 w-16 rounded-full border-2 border-fuchsia-500/40 border-t-transparent animate-spin"></div>
                <h3 class="text-lg font-bold text-white mb-1">Vypoƒç√≠t√°v√°m cenu...</h3>
                <p class="text-sm text-white/60">Analyzuji metriky z Kartao karty a tr≈æn√≠ data.</p>
            </div>
        </div>
    </div>

    <script>
        // Initialize AI Pricing System
        let pricingSystem = null;
        
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Inicializuji AI Pricing Dashboard...');
            
            // Initialize Lucide icons
            lucide.createIcons();
            
            // Wait for Firebase to be ready
            kartaoAuth.onAuthStateChanged(async (user) => {
                if (user) {
                    await initializePricingSystem();
                } else {
                    // Redirect to login if needed
                    console.log('üë§ U≈æivatel nen√≠ p≈ôihl√°≈°en');
                }
            });
        });

        async function initializePricingSystem() {
            try {
                pricingSystem = new AIPricingSystem();
                await loadCreators();
                await loadQuickStats();
                setupEventListeners();
                console.log('‚úÖ AI Pricing System inicializov√°n');
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi inicializaci:', error);
            }
        }

        async function loadCreators() {
            try {
                const select = document.getElementById('creatorSelect');
                select.innerHTML = '<option value="">Naƒç√≠t√°n√≠ tv≈Ørc≈Ø...</option>';

                const snapshot = await firebase.firestore().collection('creators')
                    .where('role', '==', 'tvurce')
                    .orderBy('displayName')
                    .get();

                select.innerHTML = '<option value="">Vyberte tv≈Ørce</option>';
                
                snapshot.docs.forEach(doc => {
                    const data = doc.data();
                    const option = document.createElement('option');
                    option.value = doc.id;
                    option.textContent = `${data.displayName} (${data.category || 'Bez kategorie'})`;
                    select.appendChild(option);
                });

                console.log(`‚úÖ Naƒçteno ${snapshot.docs.length} tv≈Ørc≈Ø`);
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ tv≈Ørc≈Ø:', error);
                const select = document.getElementById('creatorSelect');
                select.innerHTML = '<option value="">Chyba p≈ôi naƒç√≠t√°n√≠</option>';
            }
        }

        async function loadQuickStats() {
            try {
                // Load active creators count
                const creatorsSnapshot = await firebase.firestore().collection('creators')
                    .where('role', '==', 'tvurce')
                    .get();
                
                document.getElementById('activeCreatorsCount').textContent = creatorsSnapshot.docs.length;

                // Load priced profiles count
                const pricingSnapshot = await firebase.firestore().collection('pricingRecommendations')
                    .get();
                
                document.getElementById('pricedProfilesCount').textContent = pricingSnapshot.docs.length;

                console.log('‚úÖ Rychl√© statistiky naƒçteny');
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ statistik:', error);
            }
        }

        function setupEventListeners() {
            // Calculate price button
            document.getElementById('calculatePriceBtn').addEventListener('click', calculatePrice);

            // Batch operations
            document.getElementById('updateAllPricesBtn').addEventListener('click', updateAllPrices);
            document.getElementById('exportDataBtn').addEventListener('click', exportData);
            document.getElementById('generateReportBtn').addEventListener('click', generateReport);
            document.getElementById('analyzeTrendsBtn').addEventListener('click', analyzeTrends);
        }

        async function calculatePrice() {
            const creatorId = document.getElementById('creatorSelect').value;
            const contentType = document.getElementById('contentTypeSelect').value;

            if (!creatorId) {
                alert('Pros√≠m vyberte tv≈Ørce');
                return;
            }

            showLoading(true);

            try {
                const result = await pricingSystem.calculateInfluencerPrice(creatorId, contentType);
                
                // Show results
                displayPricingResults(result);
                
                // Load market comparison
                const marketData = await pricingSystem.getMarketComparison(creatorId, contentType);
                if (marketData) {
                    displayMarketComparison(marketData);
                }

            } catch (error) {
                console.error('‚ùå Chyba p≈ôi v√Ωpoƒçtu ceny:', error);
                alert('Nastala chyba p≈ôi v√Ωpoƒçtu ceny: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function displayPricingResults(result) {
            // Show results section
            document.getElementById('pricingResults').classList.remove('hidden');

            // Update price info
            document.getElementById('recommendedPrice').textContent = `${result.recommendedPrice.toLocaleString()} Kƒç`;
            document.getElementById('priceRange').textContent = `${result.priceRange.min.toLocaleString()} - ${result.priceRange.max.toLocaleString()} Kƒç`;
            
            // Update confidence
            const confidence = result.confidence;
            document.getElementById('confidenceBar').style.width = `${confidence}%`;
            document.getElementById('confidenceText').textContent = `${confidence}%`;

            // Display factors breakdown
            displayFactorsBreakdown(result.factors);

            // Display creator analysis
            if (result.factors.followers) {
                document.getElementById('totalFollowers').textContent = result.factors.followers.totalFollowers.toLocaleString();
                document.getElementById('followerTier').textContent = result.factors.followers.tier;
            }
            
            if (result.factors.engagement) {
                document.getElementById('avgEngagement').textContent = `${result.factors.engagement.rate.toFixed(2)}%`;
                document.getElementById('engagementQuality').textContent = result.factors.engagement.quality;
            }
            
            if (result.factors.reputation) {
                document.getElementById('reputationQuality').textContent = result.factors.reputation.quality;
            }

            // Scroll to results
            document.getElementById('pricingResults').scrollIntoView({ behavior: 'smooth' });
        }

        function displayFactorsBreakdown(factors) {
            const container = document.getElementById('factorsBreakdown');
            container.innerHTML = '';

            const factorData = [
                { name: 'Followe≈ôi', score: factors.followers?.score || 0, color: 'fuchsia' },
                { name: 'Engagement', score: factors.engagement?.score || 0, color: 'emerald' },
                { name: 'Niche', score: factors.niche?.score || 0, color: 'sky' },
                { name: 'Reputace', score: factors.reputation?.score || 0, color: 'amber' },
                { name: 'Trh', score: factors.market?.score || 0, color: 'rose' }
            ];

            factorData.forEach(factor => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-3 bg-neutral-900 rounded-xl border border-white/5';
                div.innerHTML = `
                    <span class="text-sm font-medium text-white/60">${factor.name}</span>
                    <div class="flex items-center">
                        <div class="w-20 h-2 bg-white/10 rounded-full mr-2 overflow-hidden">
                            <div class="h-2 bg-${factor.color}-500 rounded-full" style="width: ${factor.score}%"></div>
                        </div>
                        <span class="text-sm font-semibold text-white">${Math.round(factor.score)}/100</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function displayMarketComparison(marketData) {
            const container = document.getElementById('marketComparison');
            container.innerHTML = `
                <h4 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                    <i data-lucide="scale" class="w-5 h-5 text-emerald-300"></i>
                    <span>üìä Srovn√°n√≠ s trhem</span>
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-sm">
                    <div class="text-center p-3 rounded-xl bg-neutral-900/80 border border-white/5">
                        <div class="text-2xl font-bold text-white">${marketData.median.toLocaleString()} Kƒç</div>
                        <div class="text-xs text-white/60 mt-1">Medi√°n</div>
                    </div>
                    <div class="text-center p-3 rounded-xl bg-neutral-900/80 border border-white/5">
                        <div class="text-2xl font-bold text-white">${marketData.average.toLocaleString()} Kƒç</div>
                        <div class="text-xs text-white/60 mt-1">Pr≈Ømƒõr</div>
                    </div>
                    <div class="text-center p-3 rounded-xl bg-neutral-900/80 border border-white/5">
                        <div class="text-2xl font-bold text-white">${marketData.sampleSize}</div>
                        <div class="text-xs text-white/60 mt-1">Vzork≈Ø</div>
                    </div>
                    <div class="text-center p-3 rounded-xl bg-neutral-900/80 border border-emerald-400/40">
                        <div class="text-lg font-bold text-emerald-300">${marketData.recommendation}</div>
                        <div class="text-xs text-white/60 mt-1">Doporuƒçen√≠ AI</div>
                    </div>
                </div>
            `;
        }

        async function updateAllPrices() {
            if (!confirm('Opravdu chcete aktualizovat ceny v≈°ech tv≈Ørc≈Ø? Tato operace m≈Ø≈æe trvat nƒõkolik minut.')) {
                return;
            }

            showBatchProgress(true);
            
            try {
                await pricingSystem.updateAllPrices();
                alert('‚úÖ Hromadn√° aktualizace cen dokonƒçena');
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi hromadn√© aktualizaci:', error);
                alert('‚ùå Nastala chyba p≈ôi aktualizaci cen');
            } finally {
                showBatchProgress(false);
            }
        }

        async function exportData() {
            try {
                const snapshot = await firebase.firestore().collection('pricingRecommendations')
                    .orderBy('calculatedAt', 'desc')
                    .limit(1000)
                    .get();

                const data = snapshot.docs.map(doc => doc.data());
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `kartao-pricing-data-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                
                URL.revokeObjectURL(url);
                
                console.log('‚úÖ Data exportov√°na');
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi exportu:', error);
                alert('‚ùå Nastala chyba p≈ôi exportu dat');
            }
        }

        async function generateReport() {
            // Placeholder for report generation
            alert('üìä Generov√°n√≠ reportu bude implementov√°no v dal≈°√≠ verzi');
        }

        async function analyzeTrends() {
            // Placeholder for detailed trend analysis
            alert('üìà Podrobn√° anal√Ωza trend≈Ø bude implementov√°na v dal≈°√≠ verzi');
        }

        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.remove('hidden');
            } else {
                overlay.classList.add('hidden');
            }
        }

        function showBatchProgress(show) {
            const container = document.getElementById('batchProgress');
            if (show) {
                container.classList.remove('hidden');
                // Simulate progress
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 10;
                    if (progress > 100) progress = 100;
                    
                    document.getElementById('batchProgressBar').style.width = `${progress}%`;
                    document.getElementById('batchProgressText').textContent = `Zpracov√°no ${Math.round(progress)}%`;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => {
                            container.classList.add('hidden');
                        }, 2000);
                    }
                }, 500);
            } else {
                container.classList.add('hidden');
            }
        }
    </script>
<!-- Footer (Kartao styl) -->
<footer class="border-t border-white/10 text-center text-white/60 py-8 text-sm mt-12">
  <div class="flex flex-col md:flex-row items-center justify-center gap-4 mb-3">
    <a href="ochrana-osobnich-udaju.html" class="hover:text-white">Ochrana osobn√≠ch √∫daj≈Ø</a>
    <span class="hidden md:block">‚Ä¢</span>
    <a href="obchodni-podminky.html" class="hover:text-white">Obchodn√≠ podm√≠nky</a>
    <span class="hidden md:block">‚Ä¢</span>
    <a href="kontakt.html" class="hover:text-white">Kontakt</a>
  </div>
  ¬© 2025 <i data-lucide="crown" class="inline w-4 h-4 text-amber-300"></i> Kartao.cz ‚Äì S√≠≈• influencer≈Ø a tv≈Ørc≈Ø
</footer>

</body>
</html>
