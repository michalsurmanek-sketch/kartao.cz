<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ve≈ôejn√© ≈Ωeb≈ô√≠ƒçky - Kartao.cz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="firebase-init.js"></script>
  <script src="auth.js"></script>
  <script src="auth-header.js"></script>
  <script src="credits-system.js"></script>
  <script src="credits-header.js"></script>
    <script src="leaderboards-system.js"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <!-- Header -->
        <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white py-12">
            <div class="max-w-7xl mx-auto px-6">
                <div class="text-center">
                    <h1 class="text-4xl font-bold mb-4 flex items-center justify-center">
                        <i data-lucide="trophy" class="w-10 h-10 mr-4"></i>
                        Ve≈ôejn√© ≈Ωeb≈ô√≠ƒçky
                    </h1>
                    <p class="text-xl text-purple-100 mb-6">Nejlep≈°√≠ tv≈Ørci a firmy na Kartao.cz</p>
                    <div class="flex justify-center space-x-8">
                        <div class="text-center">
                            <div class="text-2xl font-bold" id="totalCreators">0</div>
                            <div class="text-sm text-purple-200">Aktivn√≠ch tv≈Ørc≈Ø</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold" id="totalCompanies">0</div>
                            <div class="text-sm text-purple-200">Aktivn√≠ch firem</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold" id="lastUpdated">-</div>
                            <div class="text-sm text-purple-200">Posl. aktualizace</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="bg-white shadow-sm sticky top-0 z-40">
            <div class="max-w-7xl mx-auto px-6">
                <nav class="flex space-x-8 py-4">
                    <button id="tabCreators" class="tab-btn active flex items-center px-4 py-2 rounded-lg font-semibold transition">
                        <i data-lucide="users" class="w-5 h-5 mr-2"></i>
                        Top Tv≈Ørci
                    </button>
                    <button id="tabCompanies" class="tab-btn flex items-center px-4 py-2 rounded-lg font-semibold transition">
                        <i data-lucide="building" class="w-5 h-5 mr-2"></i>
                        Top Firmy
                    </button>
                    <button id="tabCategories" class="tab-btn flex items-center px-4 py-2 rounded-lg font-semibold transition">
                        <i data-lucide="grid-3x3" class="w-5 h-5 mr-2"></i>
                        Podle Kategori√≠
                    </button>
                    <button id="tabRising" class="tab-btn flex items-center px-4 py-2 rounded-lg font-semibold transition">
                        <i data-lucide="trending-up" class="w-5 h-5 mr-2"></i>
                        Rostouc√≠ Hvƒõzdy
                    </button>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div class="max-w-7xl mx-auto px-6 py-8">

            <!-- Creators Section -->
            <div id="creatorsSection" class="tab-content">
                <!-- Filters -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <h2 class="text-2xl font-bold text-gray-800">üèÜ ≈Ωeb≈ô√≠ƒçek Tv≈Ørc≈Ø</h2>
                        <div class="flex space-x-4">
                            <select id="creatorCategory" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                <option value="overall">Celkov√© hodnocen√≠</option>
                                <option value="engagement">Engagement Rate</option>
                                <option value="followers">Poƒçet follower≈Ø</option>
                                <option value="earnings">P≈ô√≠jmy</option>
                                <option value="rating">Hodnocen√≠</option>
                                <option value="campaigns">Poƒçet kampan√≠</option>
                            </select>
                            <select id="creatorTimeframe" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                <option value="weekly">T√Ωdenn√≠</option>
                                <option value="monthly" selected>Mƒõs√≠ƒçn√≠</option>
                                <option value="quarterly">ƒåtvrtletn√≠</option>
                                <option value="yearly">Roƒçn√≠</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Top 3 Podium -->
                <div id="creatorsPodium" class="mb-8">
                    <!-- Podium will be populated here -->
                </div>

                <!-- Full Leaderboard -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="px-6 py-4 bg-gradient-to-r from-purple-50 to-blue-50 border-b">
                        <h3 class="text-lg font-bold text-gray-800">Kompletn√≠ ≈Ωeb≈ô√≠ƒçek</h3>
                    </div>
                    <div id="creatorsLeaderboard" class="divide-y divide-gray-100">
                        <!-- Leaderboard entries will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Companies Section -->
            <div id="companiesSection" class="tab-content hidden">
                <!-- Filters -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <h2 class="text-2xl font-bold text-gray-800">üè¢ ≈Ωeb≈ô√≠ƒçek Firem</h2>
                        <div class="flex space-x-4">
                            <select id="companyCategory" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="overall">Celkov√© hodnocen√≠</option>
                                <option value="campaigns">Aktivn√≠ kampanƒõ</option>
                                <option value="spending">Investice</option>
                                <option value="satisfaction">Spokojenost tv≈Ørc≈Ø</option>
                                <option value="results">ROI kampan√≠</option>
                            </select>
                            <select id="companyTimeframe" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="weekly">T√Ωdenn√≠</option>
                                <option value="monthly" selected>Mƒõs√≠ƒçn√≠</option>
                                <option value="quarterly">ƒåtvrtletn√≠</option>
                                <option value="yearly">Roƒçn√≠</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Top 3 Podium -->
                <div id="companiesPodium" class="mb-8">
                    <!-- Podium will be populated here -->
                </div>

                <!-- Full Leaderboard -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="px-6 py-4 bg-gradient-to-r from-blue-50 to-green-50 border-b">
                        <h3 class="text-lg font-bold text-gray-800">Kompletn√≠ ≈Ωeb≈ô√≠ƒçek</h3>
                    </div>
                    <div id="companiesLeaderboard" class="divide-y divide-gray-100">
                        <!-- Leaderboard entries will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Categories Section -->
            <div id="categoriesSection" class="tab-content hidden">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">üìÇ ≈Ωeb≈ô√≠ƒçky podle Kategori√≠</h2>
                    <div id="categoryLeaderboards" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Category leaderboards will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Rising Stars Section -->
            <div id="risingSection" class="tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Rising Creators -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i data-lucide="star" class="w-6 h-6 mr-2 text-yellow-500"></i>
                            Vych√°zej√≠c√≠ Hvƒõzdy - Tv≈Ørci
                        </h3>
                        <div id="risingCreators" class="space-y-4">
                            <!-- Rising creators will be populated here -->
                        </div>
                    </div>

                    <!-- Rising Companies -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i data-lucide="trending-up" class="w-6 h-6 mr-2 text-green-500"></i>
                            Rostouc√≠ Firmy
                        </h3>
                        <div id="risingCompanies" class="space-y-4">
                            <!-- Rising companies will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-sm w-full mx-4 text-center">
                <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4"></div>
                <h3 class="text-lg font-bold text-gray-800 mb-2">Naƒç√≠t√°m ≈æeb≈ô√≠ƒçky...</h3>
                <p class="text-sm text-gray-600">Poƒç√≠t√°m nejnovƒõj≈°√≠ pozice</p>
            </div>
        </div>

        <!-- Achievement Modal -->
        <div id="achievementModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
                <div class="text-center">
                    <div class="text-6xl mb-4" id="achievementBadge">üèÜ</div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2" id="achievementTitle">Gratulujeme!</h3>
                    <p class="text-gray-600 mb-6" id="achievementDescription">Dos√°hli jste nov√©ho miln√≠ku!</p>
                    <button onclick="closeAchievementModal()" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition">
                        Zav≈ô√≠t
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let leaderboardsSystem = null;
        let currentTab = 'creators';
        let autoRefreshInterval = null;

        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Inicializuji Leaderboards Dashboard...');
            
            lucide.createIcons();
            await initializeSystem();
        });

        async function initializeSystem() {
            try {
                leaderboardsSystem = new LeaderboardsSystem();
                setupEventListeners();
                await loadInitialData();
                startAutoRefresh();
                console.log('‚úÖ Leaderboards System inicializov√°n');
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi inicializaci:', error);
            }
        }

        function setupEventListeners() {
            // Tab navigation
            document.getElementById('tabCreators').addEventListener('click', () => showTab('creators'));
            document.getElementById('tabCompanies').addEventListener('click', () => showTab('companies'));
            document.getElementById('tabCategories').addEventListener('click', () => showTab('categories'));
            document.getElementById('tabRising').addEventListener('click', () => showTab('rising'));

            // Filter changes
            document.getElementById('creatorCategory').addEventListener('change', loadCreatorsLeaderboard);
            document.getElementById('creatorTimeframe').addEventListener('change', loadCreatorsLeaderboard);
            document.getElementById('companyCategory').addEventListener('change', loadCompaniesLeaderboard);
            document.getElementById('companyTimeframe').addEventListener('change', loadCompaniesLeaderboard);
        }

        async function loadInitialData() {
            showLoading(true);
            
            try {
                // Load stats
                await loadStats();
                
                // Load current tab data
                await loadCreatorsLeaderboard();
                
                console.log('‚úÖ Z√°kladn√≠ data naƒçtena');
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ dat:', error);
            } finally {
                showLoading(false);
            }
        }

        async function loadStats() {
            try {
                const stats = await leaderboardsSystem.getLeaderboardStats();
                if (stats) {
                    document.getElementById('totalCreators').textContent = stats.totalCreators.toLocaleString();
                    document.getElementById('totalCompanies').textContent = stats.totalCompanies.toLocaleString();
                    document.getElementById('lastUpdated').textContent = new Date(stats.lastUpdated).toLocaleTimeString('cs-CZ', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                }
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ statistik:', error);
            }
        }

        function showTab(tabName) {
            currentTab = tabName;
            
            // Hide all sections
            document.querySelectorAll('.tab-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Remove active from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-purple-600', 'text-white');
                btn.classList.add('text-gray-600', 'hover:bg-gray-100');
            });
            
            // Show selected section
            document.getElementById(`${tabName}Section`).classList.remove('hidden');
            
            // Activate current tab
            const activeTab = document.getElementById(`tab${tabName.charAt(0).toUpperCase() + tabName.slice(1)}`);
            activeTab.classList.add('active', 'bg-purple-600', 'text-white');
            activeTab.classList.remove('text-gray-600', 'hover:bg-gray-100');
            
            // Load tab data
            loadTabData(tabName);
        }

        async function loadTabData(tabName) {
            try {
                switch (tabName) {
                    case 'creators':
                        await loadCreatorsLeaderboard();
                        break;
                    case 'companies':
                        await loadCompaniesLeaderboard();
                        break;
                    case 'categories':
                        await loadCategoryLeaderboards();
                        break;
                    case 'rising':
                        await loadRisingStars();
                        break;
                }
            } catch (error) {
                console.error(`‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ dat pro tab ${tabName}:`, error);
            }
        }

        async function loadCreatorsLeaderboard() {
            const category = document.getElementById('creatorCategory').value;
            const timeframe = document.getElementById('creatorTimeframe').value;
            
            try {
                const leaderboard = await leaderboardsSystem.getLeaderboard('creators', category, timeframe);
                displayCreatorsPodium(leaderboard.entries.slice(0, 3));
                displayCreatorsLeaderboard(leaderboard.entries);
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ ≈æeb≈ô√≠ƒçku tv≈Ørc≈Ø:', error);
            }
        }

        function displayCreatorsPodium(topThree) {
            const container = document.getElementById('creatorsPodium');
            
            if (topThree.length < 3) {
                container.innerHTML = '<div class="text-center text-gray-500 py-8">Nedostatek dat pro podium</div>';
                return;
            }

            container.innerHTML = `
                <div class="flex justify-center items-end space-x-4 mb-8">
                    <!-- 2nd place -->
                    <div class="text-center">
                        <div class="bg-gray-100 rounded-xl p-6 h-32 flex flex-col justify-end">
                            <div class="w-16 h-16 bg-gray-300 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <img src="${topThree[1].avatar || 'https://via.placeholder.com/64'}" alt="${topThree[1].displayName}" class="w-full h-full rounded-full object-cover">
                            </div>
                            <h3 class="font-bold text-sm">${topThree[1].displayName}</h3>
                            <div class="text-xs text-gray-600">${Math.round(topThree[1].score)} bod≈Ø</div>
                        </div>
                        <div class="text-4xl mt-2">ü•à</div>
                        <div class="font-bold text-gray-600">#2</div>
                    </div>

                    <!-- 1st place -->
                    <div class="text-center">
                        <div class="bg-gradient-to-br from-yellow-100 to-yellow-200 rounded-xl p-6 h-40 flex flex-col justify-end">
                            <div class="w-20 h-20 bg-yellow-300 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <img src="${topThree[0].avatar || 'https://via.placeholder.com/80'}" alt="${topThree[0].displayName}" class="w-full h-full rounded-full object-cover">
                            </div>
                            <h3 class="font-bold text-base">${topThree[0].displayName}</h3>
                            <div class="text-sm text-gray-600">${Math.round(topThree[0].score)} bod≈Ø</div>
                            ${getChangeIndicator(topThree[0].change)}
                        </div>
                        <div class="text-5xl mt-2">ü•á</div>
                        <div class="font-bold text-yellow-600">#1</div>
                    </div>

                    <!-- 3rd place -->
                    <div class="text-center">
                        <div class="bg-orange-100 rounded-xl p-6 h-28 flex flex-col justify-end">
                            <div class="w-14 h-14 bg-orange-300 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <img src="${topThree[2].avatar || 'https://via.placeholder.com/56'}" alt="${topThree[2].displayName}" class="w-full h-full rounded-full object-cover">
                            </div>
                            <h3 class="font-bold text-xs">${topThree[2].displayName}</h3>
                            <div class="text-xs text-gray-600">${Math.round(topThree[2].score)} bod≈Ø</div>
                        </div>
                        <div class="text-3xl mt-2">ü•â</div>
                        <div class="font-bold text-orange-600">#3</div>
                    </div>
                </div>
            `;
        }

        function displayCreatorsLeaderboard(entries) {
            const container = document.getElementById('creatorsLeaderboard');
            
            container.innerHTML = entries.map(creator => `
                <div class="px-6 py-4 hover:bg-gray-50 transition cursor-pointer" onclick="showCreatorDetails('${creator.id}')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 flex items-center justify-center font-bold text-lg ${getPositionColor(creator.position)}">
                                    ${creator.position <= 10 ? getPositionEmoji(creator.position) : creator.position}
                                </div>
                                ${getChangeIndicator(creator.change)}
                            </div>
                            <div class="w-12 h-12 bg-gray-200 rounded-full overflow-hidden">
                                <img src="${creator.avatar || 'https://via.placeholder.com/48'}" alt="${creator.displayName}" class="w-full h-full object-cover">
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800">${creator.displayName}</h4>
                                <p class="text-sm text-gray-600">${creator.category || 'Bez kategorie'}</p>
                                ${creator.verified ? '<span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">Ovƒõ≈ôen√Ω</span>' : ''}
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-purple-600">${Math.round(creator.score)}</div>
                            <div class="text-sm text-gray-600">bod≈Ø</div>
                            ${creator.stats ? `<div class="text-xs text-gray-500">${creator.stats.campaignsCount || 0} kampan√≠</div>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function loadCompaniesLeaderboard() {
            const category = document.getElementById('companyCategory').value;
            const timeframe = document.getElementById('companyTimeframe').value;
            
            try {
                const leaderboard = await leaderboardsSystem.getLeaderboard('companies', category, timeframe);
                displayCompaniesPodium(leaderboard.entries.slice(0, 3));
                displayCompaniesLeaderboard(leaderboard.entries);
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ ≈æeb≈ô√≠ƒçku firem:', error);
            }
        }

        function displayCompaniesPodium(topThree) {
            const container = document.getElementById('companiesPodium');
            
            if (topThree.length < 3) {
                container.innerHTML = '<div class="text-center text-gray-500 py-8">Nedostatek dat pro podium</div>';
                return;
            }

            container.innerHTML = `
                <div class="flex justify-center items-end space-x-4 mb-8">
                    <!-- 2nd place -->
                    <div class="text-center">
                        <div class="bg-gray-100 rounded-xl p-6 h-32 flex flex-col justify-end">
                            <div class="w-16 h-16 bg-blue-100 rounded-xl mx-auto mb-2 flex items-center justify-center">
                                <i data-lucide="building" class="w-8 h-8 text-blue-600"></i>
                            </div>
                            <h3 class="font-bold text-sm">${topThree[1].companyName || topThree[1].displayName}</h3>
                            <div class="text-xs text-gray-600">${Math.round(topThree[1].score)} bod≈Ø</div>
                        </div>
                        <div class="text-4xl mt-2">ü•à</div>
                        <div class="font-bold text-gray-600">#2</div>
                    </div>

                    <!-- 1st place -->
                    <div class="text-center">
                        <div class="bg-gradient-to-br from-blue-100 to-blue-200 rounded-xl p-6 h-40 flex flex-col justify-end">
                            <div class="w-20 h-20 bg-blue-300 rounded-xl mx-auto mb-2 flex items-center justify-center">
                                <i data-lucide="building" class="w-10 h-10 text-blue-800"></i>
                            </div>
                            <h3 class="font-bold text-base">${topThree[0].companyName || topThree[0].displayName}</h3>
                            <div class="text-sm text-gray-600">${Math.round(topThree[0].score)} bod≈Ø</div>
                            ${getChangeIndicator(topThree[0].change)}
                        </div>
                        <div class="text-5xl mt-2">ü•á</div>
                        <div class="font-bold text-blue-600">#1</div>
                    </div>

                    <!-- 3rd place -->
                    <div class="text-center">
                        <div class="bg-green-100 rounded-xl p-6 h-28 flex flex-col justify-end">
                            <div class="w-14 h-14 bg-green-300 rounded-xl mx-auto mb-2 flex items-center justify-center">
                                <i data-lucide="building" class="w-7 h-7 text-green-800"></i>
                            </div>
                            <h3 class="font-bold text-xs">${topThree[2].companyName || topThree[2].displayName}</h3>
                            <div class="text-xs text-gray-600">${Math.round(topThree[2].score)} bod≈Ø</div>
                        </div>
                        <div class="text-3xl mt-2">ü•â</div>
                        <div class="font-bold text-green-600">#3</div>
                    </div>
                </div>
            `;

            // Re-initialize Lucide icons
            lucide.createIcons();
        }

        function displayCompaniesLeaderboard(entries) {
            const container = document.getElementById('companiesLeaderboard');
            
            container.innerHTML = entries.map(company => `
                <div class="px-6 py-4 hover:bg-gray-50 transition cursor-pointer" onclick="showCompanyDetails('${company.id}')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 flex items-center justify-center font-bold text-lg ${getPositionColor(company.position)}">
                                    ${company.position <= 10 ? getPositionEmoji(company.position) : company.position}
                                </div>
                                ${getChangeIndicator(company.change)}
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                                <i data-lucide="building" class="w-6 h-6 text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800">${company.companyName || company.displayName}</h4>
                                <p class="text-sm text-gray-600">${company.industry || 'Neuvedeno'}</p>
                                ${company.verified ? '<span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">Ovƒõ≈ôen√°</span>' : ''}
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-blue-600">${Math.round(company.score)}</div>
                            <div class="text-sm text-gray-600">bod≈Ø</div>
                            ${company.stats ? `<div class="text-xs text-gray-500">${company.stats.campaignsCount || 0} kampan√≠</div>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');

            // Re-initialize Lucide icons
            lucide.createIcons();
        }

        async function loadCategoryLeaderboards() {
            try {
                const categoryLeaderboards = await leaderboardsSystem.getCategoryLeaderboards();
                displayCategoryLeaderboards(categoryLeaderboards);
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ kategori√°ln√≠ch ≈æeb≈ô√≠ƒçk≈Ø:', error);
            }
        }

        function displayCategoryLeaderboards(categoryLeaderboards) {
            const container = document.getElementById('categoryLeaderboards');
            
            container.innerHTML = Object.values(categoryLeaderboards).map(categoryData => `
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">${getCategoryIcon(categoryData.category)} ${categoryData.name}</h3>
                    <div class="space-y-3">
                        ${categoryData.topCreators.map(creator => `
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer" onclick="showCreatorDetails('${creator.id}')">
                                <div class="flex items-center space-x-3">
                                    <div class="w-6 h-6 flex items-center justify-center font-bold text-sm ${getPositionColor(creator.position)}">
                                        ${getPositionEmoji(creator.position)}
                                    </div>
                                    <div class="w-8 h-8 bg-gray-200 rounded-full overflow-hidden">
                                        <img src="${creator.avatar || 'https://via.placeholder.com/32'}" alt="${creator.displayName}" class="w-full h-full object-cover">
                                    </div>
                                    <div>
                                        <h4 class="font-semibold text-sm text-gray-800">${creator.displayName}</h4>
                                        <p class="text-xs text-gray-600">${Math.round(creator.score)} bod≈Ø</p>
                                    </div>
                                </div>
                                ${creator.verified ? '<span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full">‚úì</span>' : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        async function loadRisingStars() {
            try {
                const [risingCreators, risingCompanies] = await Promise.all([
                    leaderboardsSystem.getRisingStars('creators', 10),
                    leaderboardsSystem.getRisingStars('companies', 10)
                ]);

                displayRisingCreators(risingCreators.entries);
                displayRisingCompanies(risingCompanies.entries);
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ rostouc√≠ch hvƒõzd:', error);
            }
        }

        function displayRisingCreators(creators) {
            const container = document.getElementById('risingCreators');
            
            container.innerHTML = creators.map((creator, index) => `
                <div class="flex items-center justify-between p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg hover:shadow-md transition cursor-pointer" onclick="showCreatorDetails('${creator.id}')">
                    <div class="flex items-center space-x-3">
                        <div class="text-xl">‚≠ê</div>
                        <div class="w-10 h-10 bg-gray-200 rounded-full overflow-hidden">
                            <img src="${creator.avatar || 'https://via.placeholder.com/40'}" alt="${creator.displayName}" class="w-full h-full object-cover">
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">${creator.displayName}</h4>
                            <p class="text-sm text-gray-600">${creator.category || 'Bez kategorie'}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-green-600 font-bold">+${creator.stats?.followerGrowth || 0}%</div>
                        <div class="text-xs text-gray-600">r≈Øst follower≈Ø</div>
                    </div>
                </div>
            `).join('');
        }

        function displayRisingCompanies(companies) {
            const container = document.getElementById('risingCompanies');
            
            container.innerHTML = companies.map((company, index) => `
                <div class="flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg hover:shadow-md transition cursor-pointer" onclick="showCompanyDetails('${company.id}')">
                    <div class="flex items-center space-x-3">
                        <div class="text-xl">üöÄ</div>
                        <div class="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center">
                            <i data-lucide="building" class="w-5 h-5 text-blue-600"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">${company.companyName || company.displayName}</h4>
                            <p class="text-sm text-gray-600">${company.industry || 'Neuvedeno'}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-green-600 font-bold">${company.stats?.successRate || 0}%</div>
                        <div class="text-xs text-gray-600">success rate</div>
                    </div>
                </div>
            `).join('');

            // Re-initialize Lucide icons
            lucide.createIcons();
        }

        // Helper functions
        function getPositionEmoji(position) {
            if (position === 1) return 'ü•á';
            if (position === 2) return 'ü•à';
            if (position === 3) return 'ü•â';
            if (position <= 10) return 'üèÜ';
            return position.toString();
        }

        function getPositionColor(position) {
            if (position === 1) return 'text-yellow-600';
            if (position === 2) return 'text-gray-600';
            if (position === 3) return 'text-orange-600';
            if (position <= 10) return 'text-purple-600';
            return 'text-gray-500';
        }

        function getChangeIndicator(change) {
            if (!change) return '';
            
            if (change.direction === 'up') {
                return `<div class="text-green-500 text-xs flex items-center">
                    <i data-lucide="arrow-up" class="w-3 h-3 mr-1"></i>
                    +${change.value}
                </div>`;
            } else if (change.direction === 'down') {
                return `<div class="text-red-500 text-xs flex items-center">
                    <i data-lucide="arrow-down" class="w-3 h-3 mr-1"></i>
                    -${change.value}
                </div>`;
            } else {
                return `<div class="text-gray-500 text-xs flex items-center">
                    <i data-lucide="minus" class="w-3 h-3 mr-1"></i>
                    0
                </div>`;
            }
        }

        function getCategoryIcon(category) {
            const icons = {
                'beauty': 'üíÑ',
                'fitness': 'üí™',
                'tech': 'üíª',
                'food': 'üçΩÔ∏è',
                'travel': '‚úàÔ∏è',
                'lifestyle': 'üåü'
            };
            return icons[category] || 'üìÇ';
        }

        function showCreatorDetails(creatorId) {
            // Placeholder for creator detail modal
            console.log('Zobrazuji detail tv≈Ørce:', creatorId);
            alert(`Detail tv≈Ørce ${creatorId} bude implementov√°n v dal≈°√≠ verzi`);
        }

        function showCompanyDetails(companyId) {
            // Placeholder for company detail modal
            console.log('Zobrazuji detail firmy:', companyId);
            alert(`Detail firmy ${companyId} bude implementov√°n v dal≈°√≠ verzi`);
        }

        function closeAchievementModal() {
            document.getElementById('achievementModal').classList.add('hidden');
        }

        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.remove('hidden');
            } else {
                overlay.classList.add('hidden');
            }
        }

        function startAutoRefresh() {
            // Obnoven√≠ dat ka≈æd√Ωch 5 minut
            autoRefreshInterval = setInterval(async () => {
                console.log('üîÑ Auto-refresh ≈æeb≈ô√≠ƒçk≈Ø...');
                await loadStats();
                await loadTabData(currentTab);
            }, 5 * 60 * 1000);
        }

        // Cleanup p≈ôi opu≈°tƒõn√≠ str√°nky
        window.addEventListener('beforeunload', () => {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
        });

        // CSS for tabs
        const style = document.createElement('style');
        style.textContent = `
            .tab-btn {
                transition: all 0.3s ease;
                color: #6b7280;
            }
            .tab-btn:hover {
                background-color: #f3f4f6;
            }
            .tab-btn.active {
                background-color: #9333ea;
                color: white;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>