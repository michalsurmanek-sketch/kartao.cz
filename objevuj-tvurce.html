<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Objevuj tvůrce - Kartao.cz</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            fuchsia: tailwind.colors.fuchsia,
            amber: tailwind.colors.amber,
            neutral: tailwind.colors.neutral,
            emerald: tailwind.colors.emerald,
            sky: tailwind.colors.sky,
          },
          boxShadow: {
            soft: "0 18px 45px rgba(15,23,42,0.85)"
          }
        }
      }
    };
  </script>

  <!-- Ikony -->
  <!-- Lucide ikony - unified system -->
  <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-neutral-950 via-slate-950 to-fuchsia-950 text-white">

  <!-- HLAVIČKA -->
  <header class="sticky top-0 z-30 border-b border-white/10 bg-neutral-950/85 backdrop-blur">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
      <a href="index.html" class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-2xl bg-gradient-to-tr from-fuchsia-500 to-amber-400 grid place-items-center shadow-soft">
          <i data-lucide="crown" class="w-5 h-5"></i>
        </div>
        <div>
          <span class="font-semibold text-lg">Kartao.cz</span>
          <p class="text-[11px] text-white/60">Marketplace influencerů</p>
        </div>
      </a>
      
      <div class="flex items-center gap-2">
        <a href="login.html" class="px-4 py-2 rounded-xl bg-white/10 border border-white/20 hover:bg-white/20 text-sm">
          Přihlásit se
        </a>
        <a href="register.html" class="px-4 py-2 rounded-xl bg-gradient-to-r from-fuchsia-500 to-amber-400 text-neutral-950 font-semibold text-sm hover:brightness-110">
          Registrace
        </a>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="max-w-7xl mx-auto px-4 py-12 text-center">
    <h1 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-fuchsia-400 via-amber-300 to-sky-400 bg-clip-text text-transparent">
      Objevuj tisíce influencerů
    </h1>
    <p class="text-xl text-white/70 mb-8">
      Najdi perfektního tvůrce pro tvou kampaň
    </p>

    <!-- Search & Filters -->
    <div class="max-w-3xl mx-auto space-y-4">
      <div class="relative">
        <input 
          type="text" 
          id="searchInput"
          placeholder="Hledej podle jména, handlu nebo kategorie..." 
          class="w-full px-6 py-4 rounded-2xl bg-neutral-900/80 border border-white/20 text-white placeholder-white/40 focus:outline-none focus:border-fuchsia-400"
        >
        <i data-lucide="search" class="absolute right-6 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40"></i>
      </div>

      <!-- Quick Filters -->
      <div class="flex flex-wrap gap-2 justify-center">
        <button class="filter-btn px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-fuchsia-500/20 hover:border-fuchsia-400 text-sm" data-category="all">
          Všichni
        </button>
        <button class="filter-btn px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-fuchsia-500/20 hover:border-fuchsia-400 text-sm" data-category="Lifestyle">
          Lifestyle
        </button>
        <button class="filter-btn px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-fuchsia-500/20 hover:border-fuchsia-400 text-sm" data-category="Beauty">
          Beauty
        </button>
        <button class="filter-btn px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-fuchsia-500/20 hover:border-fuchsia-400 text-sm" data-category="Fitness">
          Fitness
        </button>
        <button class="filter-btn px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-fuchsia-500/20 hover:border-fuchsia-400 text-sm" data-category="Tech">
          Tech
        </button>
        <button class="filter-btn px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-fuchsia-500/20 hover:border-fuchsia-400 text-sm" data-category="Food">
          Food
        </button>
        <button class="filter-btn px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-fuchsia-500/20 hover:border-fuchsia-400 text-sm" data-category="Travel">
          Travel
        </button>
      </div>
    </div>
  </section>

  <!-- CREATORS GRID -->
  <section class="max-w-7xl mx-auto px-4 pb-12">
    
    <!-- Loading -->
    <div id="loadingState" class="text-center py-20">
      <div class="inline-block w-12 h-12 border-4 border-fuchsia-500/30 border-t-fuchsia-500 rounded-full animate-spin"></div>
      <p class="mt-4 text-white/60">Načítám tvůrce...</p>
    </div>

    <!-- Grid -->
    <div id="creatorsGrid" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Naplní se dynamicky -->
    </div>

    <!-- Empty State -->
    <div id="emptyState" class="hidden text-center py-20">
      <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-white/5 grid place-items-center">
        <i data-lucide="inbox" class="w-8 h-8 text-white/40"></i>
      </div>
      <h3 class="text-xl font-bold mb-2">Žádní tvůrci nenalezeni</h3>
      <p class="text-white/60">Zkus změnit filtr nebo vyhledávání</p>
    </div>

  </section>

  <!-- Footer -->
  <footer class="border-t border-white/10 mt-12">
    <div class="max-w-7xl mx-auto px-4 py-6 text-center text-sm text-white/50">
      <p>© 2025 Kartao.cz - Marketplace pro influencery a značky</p>
    </div>
  </footer>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-config.js"></script>
  <script src="supabase-init.js"></script>

  <script>
    // Inicializace ikon
    if (window.lucide) {
    }

    let allCreators = [];
    let currentFilter = 'all';
    let searchTerm = '';

    async function loadCreators() {
      const sb = window.supabaseClient || window.sb;
      
      if (!sb) {
        console.error('Supabase není dostupný');
        return;
      }

      try {
        const { data: creators, error } = await sb
          .from('creators')
          .select('*')
          .order('created_at', { ascending: false })
          .limit(100);

        if (error) throw error;

        allCreators = creators || [];
        displayCreators(allCreators);

      } catch (error) {
        console.error('Chyba načítání tvůrců:', error);
        document.getElementById('loadingState').classList.add('hidden');
        document.getElementById('emptyState').classList.remove('hidden');
      }
    }

    function displayCreators(creators) {
      document.getElementById('loadingState').classList.add('hidden');
      
      if (!creators || creators.length === 0) {
        document.getElementById('creatorsGrid').classList.add('hidden');
        document.getElementById('emptyState').classList.remove('hidden');
        return;
      }

      document.getElementById('emptyState').classList.add('hidden');
      document.getElementById('creatorsGrid').classList.remove('hidden');

      const grid = document.getElementById('creatorsGrid');
      grid.innerHTML = creators.map(creator => createCreatorCard(creator)).join('');

      if (window.lucide) {
      }
    }

    function createCreatorCard(creator) {
      const category = creator.categories && creator.categories.length > 0 ? creator.categories[0] : 'Lifestyle';
      const followers = creator.instagram_followers || 0;
      const premium = creator.premium ? '<div class="absolute top-3 right-3 px-2 py-1 rounded-full bg-gradient-to-r from-yellow-400 to-amber-400 text-neutral-900 text-xs font-bold"><i data-lucide="crown" class="w-3 h-3 inline"></i> VIP</div>' : '';

      return `
        <a href="karta.html?handle=${creator.handle}" class="group block">
          <div class="rounded-3xl bg-neutral-950/60 border border-white/10 shadow-soft overflow-hidden hover:border-fuchsia-400/60 transition-all hover:scale-105">
            
            <!-- Cover -->
            <div class="relative h-32 bg-gradient-to-br from-fuchsia-700/40 to-amber-700/30">
              ${creator.cover_url ? `<img src="${creator.cover_url}" alt="Cover" class="w-full h-full object-cover">` : ''}
              <div class="absolute inset-0 bg-gradient-to-t from-neutral-950/90 to-transparent"></div>
              ${premium}
            </div>

            <!-- Content -->
            <div class="relative -mt-12 px-4 pb-4">
              <!-- Avatar -->
              <div class="w-20 h-20 rounded-2xl bg-gradient-to-tr from-fuchsia-500 to-amber-400 p-[2px] shadow-lg mb-3">
                <div class="w-full h-full rounded-2xl bg-neutral-950 grid place-items-center overflow-hidden">
                  ${creator.avatar_url 
                    ? `<img src="${creator.avatar_url}" alt="${creator.name}" class="w-full h-full object-cover">` 
                    : `<span class="text-2xl font-bold text-amber-200">${creator.name.charAt(0)}</span>`
                  }
                </div>
              </div>

              <!-- Info -->
              <h3 class="text-lg font-bold mb-1 group-hover:text-fuchsia-400 transition">${creator.name}</h3>
              <p class="text-sm text-white/60 mb-2">@${creator.handle}</p>
              
              <div class="flex items-center gap-2 mb-3">
                <span class="px-2 py-1 rounded-full bg-fuchsia-500/20 text-fuchsia-200 border border-fuchsia-400/40 text-xs">
                  ${category}
                </span>
                ${creator.city ? `<span class="text-xs text-white/50"><i data-lucide="map-pin" class="w-3 h-3 inline"></i> ${creator.city}</span>` : ''}
              </div>

              <!-- Stats -->
              <div class="grid grid-cols-3 gap-2 text-xs">
                <div class="text-center">
                  <p class="text-white/60">Followers</p>
                  <p class="font-bold">${formatNumber(followers)}</p>
                </div>
                <div class="text-center">
                  <p class="text-white/60">Rating</p>
                  <p class="font-bold">${creator.rating || '-'}</p>
                </div>
                <div class="text-center">
                  <p class="text-white/60">Cena</p>
                  <p class="font-bold">${creator.price ? formatPrice(creator.price) : '-'}</p>
                </div>
              </div>
            </div>
          </div>
        </a>
      `;
    }

    function filterCreators() {
      let filtered = allCreators;

      // Filtr podle kategorie
      if (currentFilter !== 'all') {
        filtered = filtered.filter(c => 
          c.categories && c.categories.includes(currentFilter)
        );
      }

      // Filtr podle vyhledávání
      if (searchTerm) {
        const term = searchTerm.toLowerCase();
        filtered = filtered.filter(c => 
          c.name.toLowerCase().includes(term) ||
          c.handle.toLowerCase().includes(term) ||
          (c.categories && c.categories.some(cat => cat.toLowerCase().includes(term)))
        );
      }

      displayCreators(filtered);
    }

    function formatNumber(num) {
      if (!num) return '0';
      if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
      }
      if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
      }
      return num.toLocaleString('cs-CZ');
    }

    function formatPrice(price) {
      if (!price) return '-';
      if (price >= 1000) {
        return Math.round(price / 1000) + 'K';
      }
      return price;
    }

    // Event listeners
    document.getElementById('searchInput').addEventListener('input', (e) => {
      searchTerm = e.target.value;
      filterCreators();
    });

    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        // Odstranění aktivní třídy ze všech
        document.querySelectorAll('.filter-btn').forEach(b => {
          b.classList.remove('bg-fuchsia-500/20', 'border-fuchsia-400');
        });
        
        // Přidání aktivní třídy na aktuální
        btn.classList.add('bg-fuchsia-500/20', 'border-fuchsia-400');
        
        currentFilter = btn.dataset.category;
        filterCreators();
      });
    });

    // Načti tvůrce při načtení stránky
    document.addEventListener('DOMContentLoaded', () => {
      loadCreators();
      // Nastavení "Všichni" jako aktivní
      document.querySelector('[data-category="all"]').classList.add('bg-fuchsia-500/20', 'border-fuchsia-400');
    });
  </script>

</body>
</html>
