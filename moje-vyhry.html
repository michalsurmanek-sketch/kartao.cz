<!-- Sekce Moje výhry – Kartao.cz -->
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kartao.cz – Moje výhry</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            fuchsia: tailwind.colors.fuchsia,
            amber: tailwind.colors.amber,
            neutral: tailwind.colors.neutral,
            emerald: tailwind.colors.emerald,
            rose: tailwind.colors.rose,
          },
          boxShadow: {
            soft: "0 18px 45px rgba(15,23,42,0.85)",
          },
        },
      },
    };
  </script>

  <!-- Ikony -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
</head>
<body class="min-h-screen bg-neutral-950 text-white py-10">

  <div class="max-w-5xl mx-auto px-4">
    <h1 class="text-3xl font-bold mb-2 flex items-center gap-3">
      <i data-lucide="trophy" class="w-8 h-8 text-amber-400"></i>
      Moje výhry
    </h1>
    <p class="text-sm text-white/60 mb-6">
      Tady se ti ukládají všechny výhry z <span class="text-amber-300 font-semibold">Mystery Boxu</span> a dalších odměn Kartao.cz.
    </p>

    <!-- Stav, když ještě nic nevyhrál -->
    <div id="emptyState" class="mt-10 rounded-2xl border border-dashed border-white/15 bg-neutral-900/60 px-6 py-10 text-center">
      <div class="mx-auto mb-4 w-12 h-12 rounded-2xl bg-gradient-to-tr from-fuchsia-500 to-amber-400 grid place-items-center">
        <i data-lucide="package-open" class="w-6 h-6"></i>
      </div>
      <h2 class="font-semibold text-lg mb-2">Zatím žádné výhry</h2>
      <p class="text-sm text-white/60 mb-4">Otevři svůj první Mystery Box a výhra se ti uloží právě sem.</p>
      <a href="mystery-box.html" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-fuchsia-500 to-amber-400 text-sm font-medium text-black">
        <i data-lucide="sparkles" class="w-4 h-4"></i>
        <span>Jít otevřít Mystery Box</span>
      </a>
    </div>

    <!-- GRID VÝHER (doplní se z JS) -->
    <div id="rewardsGrid" class="mt-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-6 hidden"></div>
  </div>

  <script>
    // Jen čte a zobrazuje výhry, které ukládá Mystery Box (localStorage)
    // Klíč: "kartao_rewards"

    function formatDate(dateStr) {
      const d = new Date(dateStr);
      if (isNaN(d)) return "";
      const den = String(d.getDate()).padStart(2, "0");
      const mesic = String(d.getMonth() + 1).padStart(2, "0");
      const rok = d.getFullYear();
      return `${den}. ${mesic}. ${rok}`;
    }

    function getGradientClasses(type) {
      switch (type) {
        case "mystery":
          return "from-amber-400 to-fuchsia-500";
        case "gold-card":
          return "from-emerald-400 to-emerald-600";
        case "ticket":
          return "from-rose-400 to-rose-600";
        default:
          return "from-neutral-700 to-neutral-900";
      }
    }

    function getIcon(type) {
      switch (type) {
        case "mystery":
          return "gift";
        case "gold-card":
          return "badge-check";
        case "ticket":
          return "ticket";
        default:
          return "star";
      }
    }

    window.addEventListener("DOMContentLoaded", () => {
      if (window.lucide) {
        lucide.createIcons();
      }

      const grid = document.getElementById("rewardsGrid");
      const emptyState = document.getElementById("emptyState");

      // 1) Načti výhry z localStorage (uloží je Mystery Box)
      let rewards = [];
      try {
        rewards = JSON.parse(localStorage.getItem("kartao_rewards") || "[]");
      } catch (e) {
        rewards = [];
      }

      if (!rewards || rewards.length === 0) {
        emptyState.classList.remove("hidden");
        return;
      }

      emptyState.classList.add("hidden");
      grid.classList.remove("hidden");

      rewards.forEach((reward) => {
        const card = document.createElement("div");
        card.className = "rounded-2xl shadow-soft hover:shadow-xl transition-all";

        const icon = getIcon(reward.type);

        card.innerHTML = `
          <div class="relative overflow-hidden rounded-2xl bg-gradient-to-br from-neutral-900 via-neutral-950 to-neutral-950 border border-amber-400/50 p-[1px]">
            <div class="rounded-2xl bg-neutral-950/95 px-4 py-4 flex flex-col gap-3">
              <div class="inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-emerald-500/10 border border-emerald-400/40 text-[11px] text-emerald-200">
                <span>Výhra z Mystery Boxu</span>
              </div>

              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-2xl bg-gradient-to-tr from-amber-300 to-yellow-200 flex items-center justify-center shadow-lg shadow-amber-400/70">
                  <i data-lucide="${icon}" class="w-5 h-5 text-neutral-950"></i>
                </div>
                <div class="flex-1 min-w-0">
                  <p class="text-[11px] text-amber-200/80 mb-0.5">Vyhráno: ${formatDate(reward.date)}</p>
                  <h3 class="font-semibold text-base text-amber-100 truncate">${reward.title || "Výhra"}</h3>
                </div>
              </div>

              <div class="mt-1 flex items-center justify-between gap-3">
                <div class="text-[11px] text-white/60">
                  Typ odměny:
                  <span class="font-medium text-amber-200">
                    ${reward.type === "gold-card" ? "VIP karta" : reward.type === "ticket" ? "Kupon / tiket" : "K-Coins"}
                  </span>
                </div>
                <div class="js-reward-action"></div>
              </div>
            </div>
          </div>
        `;

        const actionContainer = card.querySelector(".js-reward-action");

        if (reward.type === "mystery") {
          // K-Coins – bez tlačítka
        } else if (reward.type === "gold-card") {
          actionContainer.innerHTML = `
            <a href="vyber-vyhru.html"
               class="px-3 py-1.5 rounded-full bg-gradient-to-r from-amber-400 via-amber-300 to-yellow-300 text-[11px] font-semibold text-neutral-950 shadow-md shadow-amber-500/40 whitespace-nowrap">
              Vybrat výhru
            </a>
          `;
        } else if (reward.type === "ticket") {
          actionContainer.innerHTML = `
            <a href="mini-slevomat.html"
               class="px-3 py-1.5 rounded-full bg-gradient-to-r from-amber-400 via-amber-300 to-yellow-300 text-[11px] font-semibold text-neutral-950 shadow-md shadow-amber-500/40 whitespace-nowrap">
              Vybrat slevu
            </a>
          `;
        } else {
          actionContainer.innerHTML = `
            <button class="px-3 py-1.5 rounded-full bg-gradient-to-r from-amber-400 via-amber-300 to-yellow-300 text-[11px] font-semibold text-neutral-950 shadow-md shadow-amber-500/40 whitespace-nowrap"
                    data-reward-id="${reward.id || ""}">
              Detail
            </a>
          `;
        }

        grid.appendChild(card);
      });

      // Po dynamickém vložení ikon je znovu vygenerujeme
      if (window.lucide) {
        lucide.createIcons();
      }
    });
  </script>
</body>
</html>
