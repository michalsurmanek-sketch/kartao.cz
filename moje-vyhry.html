<!-- Sekce Moje výhry – Kartao.cz -->
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kartao.cz – Moje výhry</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            fuchsia: tailwind.colors.fuchsia,
            amber: tailwind.colors.amber,
            neutral: tailwind.colors.neutral,
            emerald: tailwind.colors.emerald,
            rose: tailwind.colors.rose,
          },
          boxShadow: {
            soft: "0 18px 45px rgba(15,23,42,0.85)",
          },
        },
      },
    };
  </script>

  <!-- Ikony -->
  <!-- Lucide ikony - unified system -->
  <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
</head>
<body class="min-h-screen bg-neutral-950 text-white py-10">

  <div class="max-w-5xl mx-auto px-4">
    <!-- Hlavička s odkazy -->
    <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4 mb-6">
      <div>
        <a href="index.html" class="inline-flex items-center gap-3 mb-3">
          <div class="w-9 h-9 rounded-2xl bg-gradient-to-tr from-amber-400 to-amber-500 grid place-items-center">
            <i data-lucide="crown" class="w-5 h-5 text-neutral-950"></i>
          </div>
          <div>
            <div class="flex items-center gap-2">
              <span class="font-semibold text-lg">Kartao.cz</span>
              <span class="px-2 py-0.5 rounded-full text-[11px] bg-amber-500/15 text-amber-200 border border-amber-400/40">
                Moje výhry
              </span>
            </div>
            <p class="text-[11px] text-white/60">Tvoje úspěchy a odměny</p>
          </div>
        </a>
        <h1 class="text-3xl font-bold mb-2 flex items-center gap-3">
          <i data-lucide="trophy" class="w-8 h-8 text-amber-400"></i>
          Moje výhry
        </h1>
        <p class="text-sm text-white/60">
          Tady se ti ukládají všechny výhry z 
          <a href="mystery-box.html" class="text-amber-300 font-semibold hover:text-amber-400 transition-all duration-200">
            Mystery Boxu
          </a>
          a dalších odměn Kartao.cz.
        </p>
      </div>
      
      <div class="flex flex-wrap gap-2 md:gap-2 md:flex-row md:items-center md:justify-start">
        <!-- Mobilní kreativní boxy -->
        <a href="mystery-box.html" class="block md:hidden flex-1 min-w-0 max-w-[120px] flex flex-col items-center justify-center gap-1 rounded-2xl border-2 border-amber-400 bg-gradient-to-tr from-amber-400/20 to-amber-500/10 px-2 py-2 text-xs font-bold text-amber-100 shadow-md hover:bg-amber-500/20 transition">
          <div class="w-8 h-8 rounded-xl bg-gradient-to-tr from-amber-400 to-amber-500 flex items-center justify-center mb-1">
            <i data-lucide="sparkles" class="w-5 h-5 text-neutral-950"></i>
          </div>
          <span>Mystery Box</span>
        </a>
        <a href="mini-slevomat.html" class="block md:hidden flex-1 min-w-0 max-w-[120px] flex flex-col items-center justify-center gap-1 rounded-2xl border-2 border-emerald-400 bg-gradient-to-tr from-emerald-400/20 to-emerald-500/10 px-2 py-2 text-xs font-bold text-emerald-100 shadow-md hover:bg-emerald-500/20 transition">
          <div class="w-8 h-8 rounded-xl bg-gradient-to-tr from-emerald-400 to-emerald-500 flex items-center justify-center mb-1">
            <i data-lucide="ticket-percent" class="w-5 h-5 text-neutral-950"></i>
          </div>
          <span>Slevy & Kupóny</span>
        </a>
        <a href="credits-dashboard.html" class="block md:hidden flex-1 min-w-0 max-w-[120px] flex flex-col items-center justify-center gap-1 rounded-2xl border-2 border-sky-400 bg-gradient-to-tr from-sky-400/20 to-sky-500/10 px-2 py-2 text-xs font-bold text-sky-100 shadow-md hover:bg-sky-500/20 transition">
          <div class="w-8 h-8 rounded-xl bg-gradient-to-tr from-sky-400 to-sky-500 flex items-center justify-center mb-1">
            <i data-lucide="arrow-left" class="w-5 h-5 text-neutral-950"></i>
          </div>
          <span>Zpět</span>
        </a>
        <!-- Desktop původní styl -->
        <a href="mystery-box.html" class="hidden md:inline-flex items-center gap-2 rounded-2xl border border-amber-500/60 bg-amber-500/10 px-3 py-1.5 text-xs font-medium text-amber-100 hover:bg-amber-500/20">
          <i data-lucide="sparkles" class="w-4 h-4"></i>
          <span>Mystery Box</span>
        </a>
        <a href="mini-slevomat.html" class="hidden md:inline-flex items-center gap-2 rounded-2xl border border-emerald-500/60 bg-emerald-500/10 px-3 py-1.5 text-xs font-medium text-emerald-100 hover:bg-emerald-500/20">
          <i data-lucide="ticket-percent" class="w-4 h-4"></i>
          <span>Slevy & Kupóny</span>
        </a>
        <a href="credits-dashboard.html" class="hidden md:inline-flex items-center gap-2 rounded-2xl border border-sky-500/60 bg-sky-500/10 px-3 py-1.5 text-xs font-medium text-sky-100 hover:bg-sky-500/20">
          <span>← Zpět na kredity</span>
        </a>
      </div>
    </div>


    <!-- Stav, když ještě nic nevyhrál -->
    <div id="emptyState" class="mt-10 rounded-2xl border border-dashed border-white/15 bg-neutral-900/60 px-6 py-10 text-center">
      <div class="mx-auto mb-4 w-12 h-12 rounded-2xl bg-gradient-to-tr from-fuchsia-500 to-amber-400 grid place-items-center">
        <i data-lucide="package-open" class="w-6 h-6"></i>
      </div>
      <h2 class="font-semibold text-lg mb-2">Zatím žádné výhry</h2>
      <p class="text-sm text-white/60 mb-4">Otevři svůj první Mystery Box a výhra se ti uloží právě sem.</p>
      <a href="mystery-box.html" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-fuchsia-500 to-amber-400 text-sm font-medium text-black">
        <i data-lucide="sparkles" class="w-4 h-4"></i>
        <span>Jít otevřít Mystery Box</span>
      </a>
    </div>

    <!-- CAROUSEL VÝHER -->
    <div id="rewardsCarousel" class="mt-6 hidden">
      <div id="carouselTrack" class="flex transition-transform duration-300 ease-in-out will-change-transform"></div>
      <div id="carouselNav" class="flex justify-center gap-2 mt-4"></div>
    </div>

    <!-- Naši partneři -->
    <section class="mt-5 mb-8">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold mb-2 flex items-center justify-center gap-2">
          <i data-lucide="handshake" class="w-7 h-7 text-amber-400"></i>
          Naši partneři
        </h2>
        <p class="text-sm text-white/60">Podpora od značek, které důvěřujeme</p>
      </div>

      <!-- Партнеры в круглых аватарках как в Instagram Stories -->
      <div class="flex flex-wrap justify-center items-center gap-6 md:gap-8">
        <!-- Partner 1 -->
        <a href="https://www.slevao.cz" target="_blank" class="group flex flex-col items-center gap-2 transition-transform hover:scale-105">
          <div class="w-20 h-20 rounded-full bg-gradient-to-tr from-amber-400 via-fuchsia-500 to-amber-400 p-[3px] shadow-lg shadow-amber-500/30">
            <div class="w-full h-full rounded-full bg-neutral-950 p-1 flex items-center justify-center">
              <div class="w-full h-full rounded-full bg-gradient-to-br from-amber-100 to-amber-300 flex items-center justify-center">
                <i data-lucide="shopping-bag" class="w-8 h-8 text-neutral-950"></i>
              </div>
            </div>
          </div>
          <span class="text-xs font-medium text-white/80 group-hover:text-amber-300 transition-colors">Slevao.cz</span>
        </a>

        <!-- Partner 2 -->
        <a href="https://www.chatao.cz" target="_blank" class="group flex flex-col items-center gap-2 transition-transform hover:scale-105">
          <div class="w-20 h-20 rounded-full bg-gradient-to-tr from-emerald-400 via-sky-500 to-fuchsia-500 p-[3px] shadow-lg shadow-emerald-500/30">
            <div class="w-full h-full rounded-full bg-neutral-950 p-1 flex items-center justify-center">
              <div class="w-full h-full rounded-full bg-gradient-to-br from-emerald-100 to-sky-300 flex items-center justify-center">
                <i data-lucide="home" class="w-8 h-8 text-neutral-950"></i>
              </div>
            </div>
          </div>
          <span class="text-xs font-medium text-white/80 group-hover:text-emerald-300 transition-colors">Chatao.cz</span>
        </a>

        <!-- Partner 3 -->
        <a href="https://www.gurmao.cz" target="_blank" class="group flex flex-col items-center gap-2 transition-transform hover:scale-105">
          <div class="w-20 h-20 rounded-full bg-gradient-to-tr from-rose-400 via-amber-500 to-emerald-400 p-[3px] shadow-lg shadow-rose-500/30">
            <div class="w-full h-full rounded-full bg-neutral-950 p-1 flex items-center justify-center">
              <div class="w-full h-full rounded-full bg-gradient-to-br from-rose-100 to-amber-200 flex items-center justify-center">
                <i data-lucide="utensils" class="w-8 h-8 text-neutral-950"></i>
              </div>
            </div>
          </div>
          <span class="text-xs font-medium text-white/80 group-hover:text-rose-300 transition-colors">Gurmao.cz</span>
        </a>

        <!-- Partner 4 -->
        <a href="#" class="group flex flex-col items-center gap-2 transition-transform hover:scale-105">
          <div class="w-20 h-20 rounded-full bg-gradient-to-tr from-sky-400 via-purple-500 to-fuchsia-500 p-[3px] shadow-lg shadow-sky-500/30">
            <div class="w-full h-full rounded-full bg-neutral-950 p-1 flex items-center justify-center">
              <div class="w-full h-full rounded-full bg-gradient-to-br from-sky-100 to-purple-300 flex items-center justify-center">
                <i data-lucide="zap" class="w-8 h-8 text-neutral-950"></i>
              </div>
            </div>
          </div>
          <span class="text-xs font-medium text-white/80 group-hover:text-sky-300 transition-colors">Zážitky+</span>
        </a>

        <!-- Partner 5 -->
        <a href="#" class="group flex flex-col items-center gap-2 transition-transform hover:scale-105">
          <div class="w-20 h-20 rounded-full bg-gradient-to-tr from-amber-400 via-rose-500 to-purple-500 p-[3px] shadow-lg shadow-amber-500/30">
            <div class="w-full h-full rounded-full bg-neutral-950 p-1 flex items-center justify-center">
              <div class="w-full h-full rounded-full bg-gradient-to-br from-amber-100 to-rose-200 flex items-center justify-center">
                <i data-lucide="gift" class="w-8 h-8 text-neutral-950"></i>
              </div>
            </div>
          </div>
          <span class="text-xs font-medium text-white/80 group-hover:text-amber-300 transition-colors">Premium club</span>
        </a>

        <!-- Partner 6 -->
        <a href="#" class="group flex flex-col items-center gap-2 transition-transform hover:scale-105">
          <div class="w-20 h-20 rounded-full bg-gradient-to-tr from-fuchsia-400 via-emerald-500 to-sky-400 p-[3px] shadow-lg shadow-fuchsia-500/30">
            <div class="w-full h-full rounded-full bg-neutral-950 p-1 flex items-center justify-center">
              <div class="w-full h-full rounded-full bg-gradient-to-br from-fuchsia-100 to-emerald-200 flex items-center justify-center">
                <i data-lucide="sparkles" class="w-8 h-8 text-neutral-950"></i>
              </div>
            </div>
          </div>
          <span class="text-xs font-medium text-white/80 group-hover:text-fuchsia-300 transition-colors">VIP travel</span>
        </a>
      </div>

      <!-- CTA pro partnery -->
      <div class="mt-10 text-center">
        <p class="text-xs text-white/50 mb-3">Chcete se stát partnerem Kartao?</p>
        <a href="mailto:partneri@kartao.cz" class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full bg-gradient-to-r from-amber-500 to-fuchsia-500 text-sm font-semibold text-white shadow-lg shadow-amber-500/30 hover:brightness-110 transition-all">
          <i data-lucide="mail" class="w-4 h-4"></i>
          <span>Kontaktujte nás</span>
        </a>
      </div>
    </section>
  </div>

  <script>
    // Jen čte a zobrazuje výhry, které ukládá Mystery Box (localStorage)
    // Klíč: "kartao_rewards"

    function formatDate(dateStr) {
      const d = new Date(dateStr);
      if (isNaN(d)) return "";
      const den = String(d.getDate()).padStart(2, "0");
      const mesic = String(d.getMonth() + 1).padStart(2, "0");
      const rok = d.getFullYear();
      return `${den}. ${mesic}. ${rok}`;
    }

    function getGradientClasses(type) {
      switch (type) {
        case "mystery":
          return "from-amber-400 to-fuchsia-500";
        case "gold-card":
          return "from-emerald-400 to-emerald-600";
        case "ticket":
          return "from-rose-400 to-rose-600";
        default:
          return "from-neutral-700 to-neutral-900";
      }
    }

    function getIcon(type) {
      switch (type) {
        case "mystery":
          return "gift";
        case "gold-card":
          return "badge-check";
        case "ticket":
          return "ticket";
        default:
          return "star";
      }
    }

    window.addEventListener("DOMContentLoaded", () => {
      if (window.lucide) {
        lucide.createIcons();
      }

      const carousel = document.getElementById("rewardsCarousel");
      const track = document.getElementById("carouselTrack");
      const nav = document.getElementById("carouselNav");
      const emptyState = document.getElementById("emptyState");

      // 1) Načti výhry z localStorage (uloží je Mystery Box)
      let rewards = [];
      try {
        rewards = JSON.parse(localStorage.getItem("kartao_rewards") || "[]");
      } catch (e) {
        rewards = [];
      }

      if (!rewards || rewards.length === 0) {
        emptyState.classList.remove("hidden");
        return;
      }

      emptyState.classList.add("hidden");
      carousel.classList.remove("hidden");

      // Vytvoř karty výher
      track.innerHTML = "";
      rewards.forEach((reward, idx) => {
        const icon = getIcon(reward.type);
        const card = document.createElement("div");
        card.className = "carousel-card min-w-full sm:min-w-[33.3333%] px-2";
        card.innerHTML = `
          <div class='rounded-2xl shadow-soft hover:shadow-xl transition-all h-full'>
            <div class="relative overflow-hidden rounded-2xl bg-gradient-to-br from-neutral-900 via-neutral-950 to-neutral-950 border border-amber-400/50 p-[1px]">
              <div class="rounded-2xl bg-neutral-950/95 px-4 py-4 flex flex-col gap-3">
                <div class="inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-emerald-500/10 border border-emerald-400/40 text-[11px] text-emerald-200">
                  <span>Výhra z Mystery Boxu</span>
                </div>
                <div class="flex items-center gap-3">
                  <div class="w-10 h-10 rounded-2xl bg-gradient-to-tr from-amber-300 to-yellow-200 flex items-center justify-center shadow-lg shadow-amber-400/70">
                    <i data-lucide='${icon}' class='w-5 h-5 text-neutral-950'></i>
                  </div>
                  <div class="flex-1 min-w-0">
                    <p class="text-[11px] text-amber-200/80 mb-0.5">Vyhráno: ${formatDate(reward.date)}</p>
                    <h3 class="font-semibold text-base text-amber-100 truncate">${reward.title || "Výhra"}</h3>
                  </div>
                </div>
                <div class="mt-1 flex items-center justify-between gap-3">
                  <div class="text-[11px] text-white/60">
                    Typ odměny:
                    <span class="font-medium text-amber-200">
                      ${reward.type === "gold-card" ? "VIP karta" : reward.type === "ticket" ? "Kupon / tiket" : "K-Coins"}
                    </span>
                  </div>
                  <div class="js-reward-action"></div>
                </div>
              </div>
            </div>
          </div>
        `;
        // Vlož akci do každé karty
        const actionContainer = card.querySelector(".js-reward-action");
        if (reward.type === "gold-card") {
          actionContainer.innerHTML = `
            <a href="vyber-vyhru.html"
              class="px-3 py-1.5 rounded-full bg-gradient-to-br from-amber-200 via-amber-300 to-yellow-200 text-[11px] font-semibold text-neutral-950 shadow-md shadow-amber-500/40 whitespace-nowrap">
              Vybrat výhru
            </a>
          `;
        } else if (reward.type === "ticket") {
          actionContainer.innerHTML = `
            <a href="mini-slevomat.html"
              class="px-3 py-1.5 rounded-full bg-gradient-to-r from-amber-400 via-amber-300 to-yellow-300 text-[11px] font-semibold text-neutral-950 shadow-md shadow-amber-500/40 whitespace-nowrap">
              Vybrat slevu
            </a>
          `;
        } else {
          actionContainer.innerHTML = `
            <button class="px-3 py-1.5 rounded-full bg-gradient-to-r from-amber-400 via-amber-300 to-yellow-300 text-[11px] font-semibold text-neutral-950 shadow-md shadow-amber-500/40 whitespace-nowrap"
                    data-reward-id="${reward.id || ""}">
              Detail
            </button>
          `;
        }
        track.appendChild(card);
      });

      // Navigace (tečky)
      nav.innerHTML = "";
      const maxDesktop = 3;
      const maxMobile = 1;
      const total = rewards.length;
      let current = 0;

      function updateCarousel() {
        const isMobile = window.innerWidth < 640;
        const visible = isMobile ? maxMobile : Math.min(maxDesktop, total);
        const offset = -current * (100 / visible);
        track.style.transform = `translateX(${offset}%)`;
        // Tečky
        nav.innerHTML = "";
        for (let i = 0; i <= total - visible; i++) {
          const dot = document.createElement("button");
          dot.className = `w-3 h-3 rounded-full mx-1 ${i === current ? 'bg-amber-400' : 'bg-white/30'}`;
          dot.addEventListener("click", () => { current = i; updateCarousel(); });
          nav.appendChild(dot);
        }
      }

      updateCarousel();

      // Swipe na mobilu
      let startX = null;
      track.addEventListener("touchstart", e => {
        startX = e.touches[0].clientX;
      });
      track.addEventListener("touchend", e => {
        if (startX === null) return;
        const endX = e.changedTouches[0].clientX;
        const delta = endX - startX;
        const isMobile = window.innerWidth < 640;
        const visible = isMobile ? maxMobile : Math.min(maxDesktop, total);
        if (Math.abs(delta) > 40) {
          if (delta < 0 && current < total - visible) current++;
          if (delta > 0 && current > 0) current--;
          updateCarousel();
        }
        startX = null;
      });

      window.addEventListener("resize", updateCarousel);

      if (window.lucide) lucide.createIcons();
    });
  </script>
</body>
</html>
